'''
Python can be used to build a simple ICMP
scanner to identify potential targets on the network. 
However, ICMP packets can be monitored or blocked 
as the target organization would not expect a
regular user to “ping a server”. On the other hand,
systems can be configured to not respond to ICMP 
requests. These are the main reasons why using the 
ARP (Address Resolution Protocol) to identify 
targets on the local network is more effective. 
'''
from scapy.all import *

interface = "eth0"           # Change this
ip_range = "10.10.X.X/24"    # change this
broadcastMac = "ff:ff:ff:ff:ff:ff"

packet = Ether(dst=broadcastMac)/ARP(pdst = ip_range) 

ans, unans = srp(packet, timeout =2, iface=interface, inter=0.1)

for send,receive in ans:
        print (receive.sprintf(r"%Ether.src% - %ARP.psrc%"))     
